# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: http://devicetree.org/schemas/sound/davinci-mcasp-audio.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: McASP Controller for TI SoCs

maintainers:
  - Jayesh Choudhary <j-choudhary@ti.com>

properties:
  compatible:
    enum:
      - ti,dm646x-mcasp-audio
      - ti,da830-mcasp-audio
      - ti,am33xx-mcasp-audio
      - ti,dra7-mcasp-audio
      - ti,omap4-mcasp-audio

  reg:
    minItems: 1
    items:
      - description: main registers
      - description: data port register

  reg-names:
    minItems: 1
    items:
      - const: mpu
      - const: dat

  op-mode:
    description: I2S - 0 or DIT - 1 mode
    enum:
      - 0
      - 1

  tdm-slots:
    maxItems: 1

  serial-dir:
    description:
      A list of serializer configuration
      Entry is indication for serializer pin direction
      0 - Inactive, 1 - TX, 2 - RX
    $ref: /schemas/types.yaml#/definitions/uint32-array
    minItems: 1
    maxItems: 16
    items:
      minimum: 0
      maximum: 2
      default: 0

  dmas:
    items:
      - description: transmission DMA channel
      - description: reception DMA channel

  dma-names:
    items:
      - const: tx
      - const: rx

  ti,hwmods:
    $ref: /schemas/types.yaml#/definitions/string
    description: Name of hwmod associated with McASP
    maxItems: 1
    deprecated: true

  tx-num-evt:
    maxItems: 1

  rx-num-evt:
    maxItems: 1

  dismod:
    enum:
      - 0
      - 2
      - 3
    default: 2

  sram-size-playback:
    maxItems: 1

  sram-size-capture:
    maxItems: 1

  interrupts:
    items:
      - description: TX FIFO interrupt
      - description: RX FIFO interrupt

  interrupt-names:
    items:
      - const: tx
      - const: rx

  fck_parent:
    description: parent clock for McASP fck
    maxItems: 1

  auxclk-fs-ratio:
    description: ratio of AUCLK and FS if applicable
    maxItems: 1

  gpio-controller: true

  "#gpio-cells":
    const: 2

  function-gpios:
    maxItems: 1

  clocks:
    maxItems: 1

  clock-names:
    const: fck

  power-domains:
    maxItems: 1

  "#sound-dai-cells":
    const: 0

required:
  - compatible
  - reg
  - reg-names
  - dmas
  - dma-names
  - interrupts
  - interrupt-names
  - serial-dir
  - op-mode
  - tdm-slots

additionalProperties: false

examples:
  - |
    mcasp0: mcasp0@1d00000 {
      compatible = "ti,da830-mcasp-audio";
      reg = <0x100000 0x3000>;
      reg-names = "mpu";
      interrupts = <82>, <83>;
      interrupt-names = "tx", "rx";
      op-mode = <0>;		/* MCASP_IIS_MODE */
      tdm-slots = <2>;
      dmas = <&main_udmap 0xc400>, <&main_udmap 0x4400>;
      dma-names = "tx", "rx";
      serial-dir = <
          0 0 0 0	/* 0: INACTIVE, 1: TX, 2: RX */
          0 0 0 0
          0 0 0 1
          2 0 0 0 >;
      tx-num-evt = <1>;
      rx-num-evt = <1>;
    };
