# SPDX-License-Identifier: (GPL-2.0+ OR MIT)
%YAML 1.2
---
$id: http://devicetree.org/schemas/phy/rockchip-mipi-dphy-rx.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Rockchip SoC MIPI RX0/TX1RX1 D-PHY Device Tree Bindings

maintainers:
  - Helen Koike <helen.koike@collabora.com>
  - Ezequiel Garcia <ezequiel@collabora.com>

description: |
  The Rockchip SoC has a MIPI D-PHY bus with an RX0 entry which connects to
  the ISP1 (Image Signal Processing unit v1.0) for CSI cameras.

properties:
  compatible:
    enum:
      - rockchip,rk3399-mipi-dphy-rx0
      - rockchip,rk3399-mipi-dphy-tx1rx1

  reg:
    maxItems: 1

  clocks:
    minItems: 3
    items:
      - description: MIPI D-PHY ref clock
      - description: MIPI D-PHY RX0/TX1RX1 cfg clock
      - description: Video in/out general register file clock
      - description: MIPI D-PHY DSI clock

  clock-names:
    minItems: 3
    items:
      - const: dphy-ref
      - const: dphy-cfg
      - const: grf
      - const: dsi

  '#phy-cells':
    const: 0

  power-domains:
    description: Video in/out power domain.
    maxItems: 1

  rockchip,grf:
    $ref: /schemas/types.yaml#/definitions/phandle
    description:
      The phandle of the syscon node for the general register file
      (GRF), required for TX1RX1 MIPI D-PHY on RK3399.

required:
  - compatible
  - clocks
  - clock-names
  - '#phy-cells'
  - power-domains

if:
  properties:
    compatible:
      contains:
          const: rockchip,rk3399-mipi-dphy-tx1rx1
then:
  required:
    - reg
    - rockchip,grf

  properties:
    clocks:
      minItems: 4
    clock-names:
      minItems: 4

additionalProperties: false

examples:
  - |

    /*
     * MIPI D-PHY RX0 use registers in "general register files", it
     * should be a child of the GRF.
     *
     * grf: syscon@ff770000 {
     *  compatible = "rockchip,rk3399-grf", "syscon", "simple-mfd";
     *  ...
     * };
     */

    #include <dt-bindings/clock/rk3399-cru.h>
    #include <dt-bindings/power/rk3399-power.h>

    mipi_dphy_rx0: mipi-dphy-rx0 {
        compatible = "rockchip,rk3399-mipi-dphy-rx0";
        clocks = <&cru SCLK_MIPIDPHY_REF>,
                 <&cru SCLK_DPHY_RX0_CFG>,
                 <&cru PCLK_VIO_GRF>;
        clock-names = "dphy-ref", "dphy-cfg", "grf";
        power-domains = <&power RK3399_PD_VIO>;
        #phy-cells = <0>;
    };
