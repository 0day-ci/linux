# SPDX-License-Identifier: GPL-2.0 OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/pwm/xlnx,axi-timer.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Xilinx LogiCORE IP AXI Timer Device Tree Binding

maintainers:
  - Sean Anderson <sean.anderson@seco.com>

properties:
  compatible:
    oneOf:
      - items:
        - const: xlnx,axi-timer-2.0
        - const: xlnx,xps-timer-1.00.a
      - const: xlnx,xps-timer-1.00.a

  clocks:
    maxItems: 1

  clock-names:
    const: s_axi_aclk

  reg:
    maxItems: 1

  xlnx,count-width:
    $ref: /schemas/types.yaml#/definitions/uint32
    minimum: 8
    maximum: 32
    description:
      The width of the counter(s), in bits.

  xlnx,gen0-assert:
    $ref: /schemas/types.yaml#/definitions/uint32
    enum: [ 0, 1 ]
    default: 1
    deprecated: true
    description:
      The polarity of the generateout0 signal. 0 for active-low, 1 for active-high.

  xlnx,gen0-active-low:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      The generate0 signal is active-low.

  xlnx,gen1-assert:
    $ref: /schemas/types.yaml#/definitions/uint32
    enum: [ 0, 1 ]
    default: 1
    deprecated: true
    description:
      The polarity of the generateout1 signal. 0 for active-low, 1 for active-high.

  xlnx,gen1-active-low:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      The generate1 signal is active-low.

  xlnx,one-timer-only:
    $ref: /schemas/types.yaml#/definitions/uint32
    enum: [ 0, 1 ]
    deprecated: true
    description:
      Whether only one timer is present in this block.

  xlnx,single-timer:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      Only one timer is present in this block.

  xlnx,pwm:
    $ref: /schemas/types.yaml#/definitions/flag
    description:
      This timer should be configured as a PWM.

required:
  - compatible
  - reg
  - xlnx,count-width

allOf:
  - if:
      required:
        - clocks
    then:
      required:
        - clock-names

  - if:
      required:
        - xlnx,gen0-active-low
    then:
      not:
        required:
          - xlnx,gen0-assert

  - if:
      required:
        - xlnx,gen0-active-low
    then:
      not:
        required:
          - xlnx,gen0-assert

  - if:
      required:
        - xlnx,one-timer-only
    then:
      not:
        required:
          - xlnx,single-timer

additionalProperties: true

examples:
  - |
    axi_timer_0: timer@800e0000 {
        clock-names = "s_axi_aclk";
        clocks = <&zynqmp_clk 71>;
        compatible = "xlnx,axi-timer-2.0", "xlnx,xps-timer-1.00.a";
        reg = <0x800e0000 0x10000>;
        xlnx,count-width = <0x20>;
        xlnx,gen0-assert = <0x1>;
        xlnx,gen1-assert = <0x1>;
        xlnx,one-timer-only = <0x0>;
        xlnx,trig0-assert = <0x1>;
        xlnx,trig1-assert = <0x1>;
    };

  - |
    axi_timer_0: timer@800e0000 {
        clock-names = "s_axi_aclk";
        clocks = <&zynqmp_clk 71>;
        compatible = "xlnx,axi-timer-2.0", "xlnx,xps-timer-1.00.a";
        reg = <0x800e0000 0x10000>;
        xlnx,count-width = <0x20>;
        xlnx,gen0-active-low;
        xlnx,single-timer;
    };
