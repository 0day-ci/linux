# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/misc/qcom,fastrpc.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Qualcomm Technologies, Inc. FastRPC Driver

maintainers:
  - Srinivas Kandagatla <srinivas.kandagatla@linaro.org>

description: |
  This binding describes Qualcomm FastRPC an IPC (Inter-Processor Communication)
  mechanism that allows for clients to transparently make remote method
  invocations across DSP and APPS boundaries. This enables developers
  to offload tasks to the DSP and free up the application processor for
  other tasks.

properties:
  compatible:
    const: qcom,fastrpc

  label:
    enum:
      - adsp
      - mdsp
      - sdsp
      - cdsp

  "#address-cells":
    const: 1

  "#size-cells":
    const: 0

patternProperties:
  "^cb@[0-9a-f]$":
    type: object
    description: |
      Compute context bank

    properties:
      compatible:
        const: qcom,fastrpc-compute-cb

      reg:
        maxItems: 1
        description: Context Bank ID

      qcom,nsessions:
        $ref: /schemas/types.yaml#/definitions/uint32
        description: How many sessions can share this context bank.
                     Defaults to 1 when this property is not specified.

    required:
      - compatible
      - reg

    additionalProperties: false

required:
  - compatible
  - label

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    adsp {
        compatible = "qcom,msm8996-adsp-pil";
        interrupts-extended = <&intc 0 162 IRQ_TYPE_EDGE_RISING>,
                              <&smp2p_adsp_in 0 IRQ_TYPE_EDGE_RISING>,
                              <&smp2p_adsp_in 1 IRQ_TYPE_EDGE_RISING>,
                              <&smp2p_adsp_in 2 IRQ_TYPE_EDGE_RISING>,
                              <&smp2p_adsp_in 3 IRQ_TYPE_EDGE_RISING>;
        interrupt-names = "wdog", "fatal", "ready", "handover", "stop-ack";
        clocks = <&xo_board>;
        clock-names = "xo";
        memory-region = <&adsp_region>;
        qcom,smem-states = <&smp2p_adsp_out 0>;
        qcom,smem-state-names = "stop";

        smd-edge {
            label = "lpass";

            fastrpc {
                compatible = "qcom,fastrpc";
                label = "adsp";
                #address-cells = <1>;
                #size-cells = <0>;

                cb@1 {
                    compatible = "qcom,fastrpc-compute-cb";
                    reg = <1>;
                };

                cb@2 {
                    compatible = "qcom,fastrpc-compute-cb";
                    reg = <2>;
                };
            };
        };
    };
